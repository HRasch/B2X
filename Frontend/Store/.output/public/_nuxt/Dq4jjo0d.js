import{j as E,c as i,a,s as g,t as s,o as c,E as P,k as j,r as h,m as q,l as $,b as R,v as L,A as O,w as U,p as G,F as S,q as B,d as H,n as Q,G as W,H as Z,_ as J}from"./C9zZ3pWr.js";const K={class:"card bg-base-100 shadow-lg hover:shadow-xl transition-all hover:-translate-y-1 h-full flex flex-col","data-testid":"product-card"},X={class:"relative h-48 overflow-hidden"},Y=["src","alt"],z={key:0,class:"absolute inset-0 bg-black/50 flex items-center justify-center"},ee={class:"card-body flex flex-col flex-1"},te={class:"card-title text-base line-clamp-2","data-testid":"product-name"},ae={class:"flex items-center gap-1"},oe={class:"text-sm"},re={class:"text-sm opacity-70 line-clamp-2"},se={class:"bg-base-200 rounded-lg p-3 mb-4"},ne={class:"flex justify-between items-start mb-2"},ce={class:"text-3xl font-bold text-primary","data-testid":"product-price"},ie={class:"text-xs opacity-70"},le={key:0,class:"mt-2 flex gap-2"},de={key:0,class:"text-xs line-through opacity-70"},ue={key:1,class:"badge badge-error badge-sm"},ve={key:1,class:"btn btn-disabled w-full mt-auto"},me=E({__name:"ProductCard",props:{product:{}},emits:["add-to-cart"],setup(l){const e=l,n=u=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}).format(u),o=()=>e.product.priceBreakdown?e.product.priceBreakdown.PriceIncludingVat:e.product.price??0,r=()=>e.product.priceBreakdown?e.product.priceBreakdown.VatRate:.19;return(u,v)=>(c(),i("div",K,[a("figure",X,[a("img",{src:l.product.image,alt:l.product.name,class:"w-full h-full object-cover"},null,8,Y),l.product.inStock?g("",!0):(c(),i("div",z,[...v[1]||(v[1]=[a("span",{class:"text-white font-bold text-sm"},"Nicht verf√ºgbar",-1)])]))]),a("div",ee,[a("h3",te,s(l.product.name),1),a("div",ae,[v[2]||(v[2]=a("span",{class:"text-yellow-500"},"‚òÖ",-1)),a("span",oe,s(l.product.rating),1)]),a("p",re,s(l.product.description),1),v[3]||(v[3]=a("div",{class:"divider my-2"},null,-1)),a("div",se,[a("div",ne,[a("span",ce,s(n(o())),1)]),a("p",ie,"inkl. MwSt "+s((r()*100).toFixed(0))+"%",1),l.product.priceBreakdown?.OriginalPrice||l.product.priceBreakdown?.DiscountAmount?(c(),i("div",le,[l.product.priceBreakdown?.OriginalPrice?(c(),i("span",de,s(n(l.product.priceBreakdown.OriginalPrice)),1)):g("",!0),l.product.priceBreakdown?.DiscountAmount?(c(),i("span",ue," -"+s(n(l.product.priceBreakdown.DiscountAmount)),1)):g("",!0)])):g("",!0)]),l.product.inStock?(c(),i("button",{key:0,onClick:v[0]||(v[0]=m=>u.$emit("add-to-cart",l.product)),class:"btn btn-primary w-full mt-auto"}," In Warenkorb ")):(c(),i("button",ve,"Nicht verf√ºgbar"))])]))}});class T{static async searchProducts(e,n=1,o=20){try{if(!e.searchTerm||e.searchTerm.trim()==="")throw new Error("Search term is required");n<1&&(n=1),(o<1||o>100)&&(o=20);const r=new URLSearchParams({term:e.searchTerm.trim(),page:n.toString(),pageSize:o.toString(),language:e.language||"de",onlyAvailable:(e.onlyAvailable!==!1).toString(),sortBy:e.sortBy||"relevance"});return e.category&&r.append("category",e.category),e.minPrice!==void 0&&e.minPrice>0&&r.append("minPrice",e.minPrice.toString()),e.maxPrice!==void 0&&e.maxPrice>0&&r.append("maxPrice",e.maxPrice.toString()),(await P.get(`/catalog/products/elasticsearch?${r.toString()}`)).data}catch(r){throw console.error("Error searching products:",r),r}}static async getProductById(e){try{return(await P.get(`/catalog/products/${e}`)).data}catch(n){throw console.error(`Error fetching product ${e}:`,n),n}}static async getProducts(e=1,n=20,o){try{e<1&&(e=1),(n<1||n>100)&&(n=20);const r=new URLSearchParams({page:e.toString(),pageSize:n.toString()});return o?.category&&r.append("category",o.category),o?.minPrice!==void 0&&o.minPrice>0&&r.append("minPrice",o.minPrice.toString()),o?.maxPrice!==void 0&&o.maxPrice>0&&r.append("maxPrice",o.maxPrice.toString()),(await P.get(`/catalog/products?${r.toString()}`)).data}catch(r){throw console.error("Error fetching products:",r),r}}static async getCatalogStats(){try{return(await P.get("/catalog/products/stats")).data}catch(e){throw console.error("Error fetching catalog statistics:",e),e}}}const ge={class:"store-container"},pe={class:"store-header"},he={class:"header-actions"},ye={class:"search-bar"},be=["placeholder","disabled"],Pe={key:0,class:"search-time"},fe={class:"category-filter"},ke=["onClick","disabled"],$e={key:0,class:"search-info"},we={key:1,class:"loading-container"},_e={key:2,class:"error-container"},xe={class:"error-message"},Ce={key:3,class:"products-grid"},Se={key:0,class:"no-products"},Be={key:0,class:"suggestion"},Te={key:4,class:"pagination"},Ee=["disabled"],Ae={class:"pagination-info"},Fe=["disabled"],Ne=E({__name:"Store",setup(l){const e=j(),n=h([]),o=h(!1),r=h(null),u=h(""),v=h("Alle"),m=h(1),w=h(20),b=h(1),_=h(0),f=h(0),A=h(["Alle","Elektronik","Zubeh√∂r"]),y=async()=>{o.value=!0,r.value=null;try{const t={searchTerm:u.value.trim()||"*",category:v.value!=="Alle"?v.value:void 0,language:"de",onlyAvailable:!0};let d;u.value.trim()?d=await T.searchProducts(t,m.value,w.value):d=await T.getProducts(m.value,w.value,t),n.value=d.items,m.value=d.page,b.value=d.totalPages,_.value=d.totalCount,d.searchMetadata&&(f.value=d.searchMetadata.queryExecutionTimeMs)}catch(t){r.value=t instanceof Error?t.message:"Failed to load products",console.error("Product loading error:",t),n.value=[]}finally{o.value=!1}};let x;const F=()=>{clearTimeout(x),m.value=1,x=setTimeout(()=>{y()},300)},N=()=>{m.value=1,y()},C=t=>{t>=1&&t<=b.value&&(m.value=t,y())},D=t=>{e.addItem({id:t.id,name:t.name,price:t.price,quantity:1,image:t.image||"https://via.placeholder.com/100?text=No+Image"})};q(()=>{y()});const k=$(()=>n.value),I=$(()=>m.value<b.value),V=$(()=>m.value>1);return(t,d)=>{const M=G("router-link");return c(),i("div",ge,[a("div",pe,[a("h1",null,s(t.$t("store.title")),1),a("div",he,[a("div",ye,[L(a("input",{"onUpdate:modelValue":d[0]||(d[0]=p=>u.value=p),type:"text",placeholder:t.$t("store.searchPlaceholder"),onInput:F,disabled:o.value},null,40,be),[[O,u.value]]),f.value>0?(c(),i("div",Pe,s(t.$t("store.searchTime",{time:f.value})),1)):g("",!0)]),R(M,{to:"/cart",class:"cart-button"},{default:U(()=>[H(" üõí "+s(t.$t("store.cart",{count:Q(e).items.length})),1)]),_:1})])]),a("div",fe,[(c(!0),i(S,null,B(A.value,p=>(c(),i("button",{key:p,onClick:()=>{v.value=p,N()},class:W(["category-btn",{active:v.value===p}]),disabled:o.value},s(p),11,ke))),128))]),!o.value&&u.value?(c(),i("div",$e,[a("p",null,s(t.$t("store.productsCount",{count:_.value}))+s(u.value?` ${t.$t("store.foundFor")} "${u.value}"`:""),1)])):g("",!0),o.value?(c(),i("div",we,[d[3]||(d[3]=a("div",{class:"spinner"},null,-1)),a("p",null,s(t.$t("ui.loadingProducts")),1)])):g("",!0),r.value&&!o.value?(c(),i("div",_e,[a("p",xe,"‚ùå "+s(t.$t("store.errorLoadingProducts",{error:r.value})),1),a("button",{onClick:y,class:"retry-button"},s(t.$t("ui.retry")),1)])):g("",!0),!o.value&&!r.value?(c(),i("div",Ce,[k.value.length===0?(c(),i("div",Se,[a("p",null,s(t.$t("store.noProductsFound")),1),u.value?(c(),i("p",Be,s(t.$t("store.tryAdjustingFilters")),1)):g("",!0)])):g("",!0),(c(!0),i(S,null,B(k.value,p=>(c(),Z(me,{key:p.id,product:p,onAddToCart:D},null,8,["product"]))),128))])):g("",!0),!o.value&&k.value.length>0?(c(),i("div",Te,[a("button",{onClick:d[1]||(d[1]=p=>C(m.value-1)),disabled:!V.value,class:"pagination-btn"},s(t.$t("store.previousPage")),9,Ee),a("div",Ae,s(t.$t("store.pageOf",{current:m.value,total:b.value})),1),a("button",{onClick:d[2]||(d[2]=p=>C(m.value+1)),disabled:!I.value,class:"pagination-btn"},s(t.$t("store.nextPage")),9,Fe)])):g("",!0)])}}}),Ie=J(Ne,[["__scopeId","data-v-04d5d79e"]]);export{Ie as default};
