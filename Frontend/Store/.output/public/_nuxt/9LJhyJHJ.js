import{j as D,k as I,r as m,l as f,m as z,c as a,a as t,n as b,b as w,w as V,p as U,F as x,q as F,s as g,t as o,v as y,x as Z,y as G,z as R,o as i,d as S,A as T,B as W,_ as j}from"./C9zZ3pWr.js";const A={class:"cart-container"},Q={key:0,class:"empty-cart"},H={key:1,class:"cart-content"},K={class:"cart-items"},P=["src","alt"],J={class:"item-details"},O={class:"item-quantity"},X=["onClick"],Y=["onUpdate:modelValue"],ee=["onClick"],te={class:"item-subtotal"},se=["onClick"],ne={class:"cart-summary"},oe={class:"summary-row"},ae={class:"summary-row"},ie={class:"shipping-section"},le={class:"shipping-info"},re={key:0,class:"shipping-methods"},ue=["id","value"],de=["for"],ce={class:"method-name"},pe={class:"method-description"},ve={class:"method-cost"},he={key:1,class:"shipping-error"},me={key:0,class:"summary-row shipping-row"},_e={class:"summary-row total"},fe=D({__name:"Cart",setup(ge){const q=R(),c=I(),v=m("DE"),u=m(""),l=m([]),h=m(0),d=m(""),_=f(()=>c.items.reduce((n,e)=>n+e.price*e.quantity,0)),k=f(()=>_.value*.19),B=f(()=>_.value+k.value+h.value),E=n=>{const e=c.items.find(r=>r.id===n);e&&e.quantity++},M=n=>{const e=c.items.find(r=>r.id===n);e&&e.quantity>1&&e.quantity--},N=n=>{c.removeItem(n)},C=async()=>{if(l.value=[],u.value="",h.value=0,d.value="",!!v.value)try{const n=await fetch(`http://localhost:7005/api/cart/shipping-methods?destinationCountry=${v.value}`);if(!n.ok){d.value="Versand zu diesem Land nicht verfügbar";return}const e=await n.json();if(e.success&&e.methods){if(l.value=e.methods,l.value.length>0){u.value=l.value[0].id;const r=l.value[0];h.value=r.cost}}else d.value=e.message||"Fehler beim Laden der Versandarten"}catch(n){console.error("Error fetching shipping methods:",n),d.value="Fehler beim Laden der Versandarten"}},L=()=>{const n=l.value.find(e=>e.id===u.value);n&&(h.value=n.cost)},$=()=>{if(!u.value){d.value="Bitte wählen Sie eine Versandart aus";return}q.push("/checkout")};return z(async()=>{v.value&&await C()}),(n,e)=>{const r=U("router-link");return i(),a("div",A,[e[13]||(e[13]=t("h1",null,"Warenkorb",-1)),b(c).items.length===0?(i(),a("div",Q,[e[3]||(e[3]=t("p",null,"Ihr Warenkorb ist leer",-1)),w(r,{to:"/shop",class:"continue-shopping"},{default:V(()=>[...e[2]||(e[2]=[S(" Zum Einkaufen ",-1)])]),_:1})])):(i(),a("div",H,[t("div",K,[(i(!0),a(x,null,F(b(c).items,s=>(i(),a("div",{key:s.id,class:"cart-item"},[t("img",{src:s.image,alt:s.name,class:"item-image"},null,8,P),t("div",J,[t("h3",null,o(s.name),1),t("p",null,"Preis: "+o(s.price)+"€",1)]),t("div",O,[t("button",{onClick:p=>M(s.id)},"-",8,X),y(t("input",{"onUpdate:modelValue":p=>s.quantity=p,type:"number",min:"1"},null,8,Y),[[T,s.quantity,void 0,{number:!0}]]),t("button",{onClick:p=>E(s.id)},"+",8,ee)]),t("div",te,o((s.price*s.quantity).toFixed(2))+"€",1),t("button",{onClick:p=>N(s.id),class:"remove-btn"},"✕",8,se)]))),128))]),t("div",ne,[e[12]||(e[12]=t("h2",null,"Zusammenfassung",-1)),t("div",oe,[e[4]||(e[4]=t("span",null,"Zwischensumme:",-1)),t("span",null,o(_.value.toFixed(2))+"€",1)]),t("div",ae,[e[5]||(e[5]=t("span",null,"Steuern (19%):",-1)),t("span",null,o(k.value.toFixed(2))+"€",1)]),t("div",ie,[e[8]||(e[8]=t("h3",null,"Versand",-1)),t("div",le,[e[7]||(e[7]=t("label",{for:"country"},"Lieferziel:",-1)),y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),id:"country",onChange:C},[...e[6]||(e[6]=[G('<option value="" data-v-7af4c576>Bitte wählen...</option><option value="DE" data-v-7af4c576>Deutschland</option><option value="AT" data-v-7af4c576>Österreich</option><option value="BE" data-v-7af4c576>Belgien</option><option value="FR" data-v-7af4c576>Frankreich</option><option value="NL" data-v-7af4c576>Niederlande</option><option value="CH" data-v-7af4c576>Schweiz</option><option value="GB" data-v-7af4c576>Großbritannien</option>',8)])],544),[[Z,v.value]])]),l.value.length>0?(i(),a("div",re,[(i(!0),a(x,null,F(l.value,s=>(i(),a("div",{key:s.id,class:"shipping-option"},[y(t("input",{id:`shipping-${s.id}`,"onUpdate:modelValue":e[1]||(e[1]=p=>u.value=p),type:"radio",value:s.id,onChange:L},null,40,ue),[[W,u.value]]),t("label",{for:`shipping-${s.id}`,class:"shipping-label"},[t("span",ce,o(s.name),1),t("span",pe,o(s.description),1),t("span",ve,o(s.cost.toFixed(2))+"€",1)],8,de)]))),128))])):g("",!0),d.value?(i(),a("div",he,o(d.value),1)):g("",!0)]),u.value?(i(),a("div",me,[e[9]||(e[9]=t("span",null,"Versand:",-1)),t("span",null,"+"+o(h.value.toFixed(2))+"€",1)])):g("",!0),t("div",_e,[e[10]||(e[10]=t("span",null,"Gesamtpreis (inkl. MwSt):",-1)),t("span",null,o(B.value.toFixed(2))+"€",1)]),t("button",{onClick:$,class:"checkout-btn"},"Zur Kasse gehen"),w(r,{to:"/shop",class:"continue-shopping"},{default:V(()=>[...e[11]||(e[11]=[S(" Weiter einkaufen ",-1)])]),_:1})])]))])}}}),ke=j(fe,[["__scopeId","data-v-7af4c576"]]);export{ke as default};
