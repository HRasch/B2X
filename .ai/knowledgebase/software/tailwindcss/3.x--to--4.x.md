# TailwindCSS 3.x → 4.x Migration Guide

**DocID**: KB-TAILWIND-4  
**Created**: 7. Januar 2026  
**Status**: Research  
**B2Connect Relevance**: HIGH - Store uses TailwindCSS 3.4.x, Admin/Management already on v4.x

## Quick Summary

TailwindCSS v4.0 is a ground-up rewrite featuring CSS-first configuration, 3.5x faster full builds, 100x+ faster incremental rebuilds, and modern CSS features (cascade layers, `@property`, `color-mix()`). Requires Safari 16.4+, Chrome 111+, Firefox 128+. **DaisyUI 5.x is fully compatible with TailwindCSS v4.**

## B2Connect Current State

| Frontend | TailwindCSS | DaisyUI | Status |
|----------|-------------|---------|--------|
| **Store** | 3.4.19 | 5.5.14 | ⚠️ Needs migration |
| **Admin** | 4.1.18 | 5.5.14 | ✅ Already migrated |
| **Management** | 4.1.18 | - | ✅ Already migrated |

## Breaking Changes

| Change | v3 | v4 | Migration Action |
|--------|-----|-----|-----------|
| **Import method** | `@tailwind base/components/utilities` | `@import "tailwindcss"` | Replace directives |
| **PostCSS plugin** | `tailwindcss` package | `@tailwindcss/postcss` | Change plugin import |
| **Config file** | `tailwind.config.js` required | CSS-first (`@theme {}`) | Migrate to CSS or use `@config` |
| **shadow-sm** | Current `shadow-sm` | Now `shadow-xs` | Update utility classes |
| **shadow** | Current `shadow` | Now `shadow-sm` | Update utility classes |
| **rounded-sm** | Current `rounded-sm` | Now `rounded-xs` | Update utility classes |
| **rounded** | Current `rounded` | Now `rounded-sm` | Update utility classes |
| **blur-sm** | Current `blur-sm` | Now `blur-xs` | Update utility classes |
| **ring** | `3px` default | `1px` default | Use `ring-3` for old behavior |
| **outline-none** | Hidden outline (accessible) | Actually none | Use `outline-hidden` |
| **border color** | `gray-200` default | `currentColor` | Add explicit `border-gray-200` |
| **Content paths** | Configured in JS | Auto-detected | Remove content config |
| **Prefix syntax** | `tw-flex` | `tw:flex` (variant-style) | Update all prefixed classes |
| **Important modifier** | `!flex` (beginning) | `flex!` (end) | Move `!` to end |
| **Arbitrary vars** | `bg-[--color]` | `bg-(--color)` | Change brackets to parens |
| **Variant stacking** | Right-to-left | Left-to-right | Reverse order-sensitive variants |
| **Hover on mobile** | Always applied | Only when `hover: hover` | May need `@custom-variant` |

## Removed Utilities

| Removed | Replacement |
|---------|-------------|
| `bg-opacity-*` | `bg-black/50` (opacity modifier) |
| `text-opacity-*` | `text-black/50` |
| `border-opacity-*` | `border-black/50` |
| `flex-shrink-*` | `shrink-*` |
| `flex-grow-*` | `grow-*` |
| `overflow-ellipsis` | `text-ellipsis` |
| `decoration-slice/clone` | `box-decoration-slice/clone` |
| `input-bordered` | Default (use `input-ghost` to remove) |
| `select-bordered` | Default (use `select-ghost` to remove) |

## New Features

- **CSS-first configuration**: Configure via `@theme {}` in CSS instead of JS
- **CSS theme variables**: All tokens exposed as CSS custom properties
- **Native cascade layers**: Better style isolation
- **color-mix()**: Opacity modifiers work on any color including CSS vars
- **Container queries**: Built-in `@container` and `@sm:`, `@md:` variants
- **3D transforms**: `rotate-x-*`, `rotate-y-*`, `scale-z-*`, `translate-z-*`
- **Gradient improvements**: Angles (`bg-linear-45`), radial/conic gradients
- **@starting-style**: `starting:` variant for enter/exit animations
- **not-* variant**: `:not()` pseudo-class support
- **Dynamic values**: Grid sizes, spacing work without configuration
- **P3 color palette**: Modernized OKLCH-based colors

## Configuration Migration

### Before (v3 - JavaScript)
```javascript
// tailwind.config.js
module.exports = {
  content: ['./components/**/*.vue', './pages/**/*.vue'],
  theme: {
    extend: {
      colors: {
        primary: { 500: '#0b98ff', 600: '#0078d4' }
      }
    }
  },
  plugins: [require('daisyui')]
}
```

### After (v4 - CSS-first)
```css
/* app.css */
@import "tailwindcss";
@import "daisyui";

@theme {
  --color-primary-500: #0b98ff;
  --color-primary-600: #0078d4;
}
```

### Alternative: Keep JS Config (v4)
```css
/* app.css */
@import "tailwindcss";
@config "../../tailwind.config.js";
```

## PostCSS Configuration Changes

### Before (v3)
```javascript
// postcss.config.js
export default {
  plugins: {
    'postcss-import': {},
    tailwindcss: {},
    autoprefixer: {},
  }
}
```

### After (v4)
```javascript
// postcss.config.js
export default {
  plugins: {
    '@tailwindcss/postcss': {},
  }
}
```

## Vite Plugin (Recommended for v4)

```javascript
// vite.config.ts
import tailwindcss from '@tailwindcss/vite'

export default defineConfig({
  plugins: [tailwindcss()],
})
```

## DaisyUI Compatibility

| DaisyUI Version | TailwindCSS Compatibility | Status |
|-----------------|---------------------------|--------|
| v4.x | TailwindCSS 3.x only | ❌ Legacy |
| **v5.x** | TailwindCSS 4.x | ✅ Current |

### DaisyUI v5 Breaking Changes (Already Applied in B2Connect)
- `online` → `avatar-online`
- `offline` → `avatar-offline`
- `card-bordered` → `card-border`
- `tabs-lifted` → `tabs-lift`
- `active` → `menu-active` (menu items)
- `disabled` → `menu-disabled` (menu items)
- `input-bordered` → removed (default has border)
- `select-bordered` → removed (default has border)
- `btm-nav` → `dock` (bottom navigation)
- `form-control` → `fieldset` with `legend`

## Browser Support Changes

| Browser | v3 Minimum | v4 Minimum |
|---------|------------|------------|
| Safari | 14.1 | **16.4** |
| Chrome | 88 | **111** |
| Firefox | 78 | **128** |
| Edge | 88 | 111 |

**⚠️ Critical**: v4 uses `@property`, `color-mix()`, and native cascade layers - no polyfills available.

## Migration Checklist

### For Store Frontend (v3 → v4)

- [ ] **Update dependencies**
  ```bash
  npm uninstall tailwindcss @nuxtjs/tailwindcss
  npm install tailwindcss@^4.1 @tailwindcss/postcss@^4.1 @tailwindcss/vite@^4.1
  ```

- [ ] **Run upgrade tool** (handles most changes automatically)
  ```bash
  npx @tailwindcss/upgrade
  ```

- [ ] **Update PostCSS config** - Replace tailwindcss with @tailwindcss/postcss

- [ ] **Update CSS imports**
  ```css
  /* Before */
  @tailwind base;
  @tailwind components;
  @tailwind utilities;
  
  /* After */
  @import "tailwindcss";
  @import "daisyui";
  ```

- [ ] **Migrate config to CSS** or add `@config` directive

- [ ] **Update renamed utilities**
  - `shadow-sm` → `shadow-xs`
  - `shadow` → `shadow-sm`  
  - `rounded-sm` → `rounded-xs`
  - `rounded` → `rounded-sm`
  - `ring` → `ring-3`
  - `outline-none` → `outline-hidden`

- [ ] **Add explicit border colors** where using `border` without color

- [ ] **Update arbitrary CSS variable syntax**: `[--var]` → `(--var)`

- [ ] **Test hover interactions** on touch devices

- [ ] **Verify all DaisyUI components** render correctly

- [ ] **Run full test suite** including visual regression

## Build Tooling Requirements

| Tool | v3 Required | v4 Required |
|------|-------------|-------------|
| Node.js | 14+ | **20+** |
| PostCSS | 8.x | 8.x |
| Vite | 4.x+ | 5.x+ (recommended) |
| postcss-import | Required | **Not needed** |
| autoprefixer | Required | **Not needed** |

## Nuxt.js Specific Notes

For `@nuxtjs/tailwindcss`:
- v6.x supports TailwindCSS 3.x
- Nuxt 4 will have native TailwindCSS v4 support
- Alternative: Use `@tailwindcss/vite` directly in Nuxt

```typescript
// nuxt.config.ts (with Vite plugin approach)
export default defineNuxtConfig({
  css: ['~/assets/css/main.css'],
  vite: {
    plugins: [tailwindcss()]
  }
})
```

## Risks & Mitigations

| Risk | Impact | Mitigation |
|------|--------|------------|
| Browser support drop | Users on older browsers | Check analytics; provide graceful degradation |
| Utility name changes break UI | Visual regressions | Run upgrade tool; visual regression tests |
| Custom plugins incompatible | Build failures | Review plugins; most v3 plugins work |
| Nuxt module compatibility | Integration issues | Use Vite plugin directly if needed |
| CSS-in-Vue `@apply` scope | Styles not applied | Use `@reference` directive |
| Build time regression | CI/CD slowdown | Unlikely - v4 is significantly faster |

## Performance Comparison

| Metric | v3 | v4 | Improvement |
|--------|----|----|-------------|
| Full build | 378ms | 100ms | **3.78x faster** |
| Incremental (new CSS) | 44ms | 5ms | **8.8x faster** |
| Incremental (no new CSS) | 35ms | 192µs | **182x faster** |

## Recommendation

### ✅ PROCEED with migration for Store frontend

**Rationale:**
1. Admin and Management already successfully running v4.1.18
2. DaisyUI 5.x already in use (v4 compatible)
3. Significant performance improvements
4. Upgrade tool automates most changes
5. Modern CSS features enable cleaner code
6. Browser support requirements are acceptable for B2B context

**Recommended Approach:**
1. Create feature branch for migration
2. Run `npx @tailwindcss/upgrade` 
3. Manually review and fix any remaining issues
4. Run full E2E and visual regression test suite
5. Test on target browsers (Chrome, Firefox, Safari, Edge)
6. Deploy to staging for QA review

**Timeline Estimate:** 2-4 hours for migration + 2 hours for testing

## Related Documents

- [KB-055] Nuxt 3.x → 4.x Migration Guide
- [GL-010] Frontend Architecture Guidelines
- [ADR-xxx] TailwindCSS Migration Decision (to be created)

## References

- [TailwindCSS v4.0 Upgrade Guide](https://tailwindcss.com/docs/upgrade-guide)
- [TailwindCSS v4.0 Release Blog](https://tailwindcss.com/blog/tailwindcss-v4)
- [DaisyUI v5 Changelog](https://daisyui.com/docs/changelog/)
- [DaisyUI v5 Documentation](https://daisyui.com/docs/v5/)
